# tcp-сервер хранилище
Данный проект представляет собой tcp-сервер с хранилещем (БД) в виде ключ-значение (как redis).

---
### Возможности:
- Запись данных на сервер (PUT)
- Получение данных с сервера (GET)
- Удаление данных с сервера (DEL)
- Получение числа пар ключ-значение (COUNT)
- Сохранение текущего хранилища в dump-файл (DUMP)
- Загрузка на сервер данных из dump-файла
- Логгирование процесса работы сервера в файлы
---
### Зависимости:
- Boost.Asio (должна быть возможность поиска библиотеки Boost через find_package), в проекте используется библиотека Boost.Asio для работы с сетью.
- spdlog для логгирования
---
### Сборка и запуск
1. Для сборки проекта требуется перейти в корень проекта и выполнить следующую команду:
**Linux:**
```bash
sudo chmod +x build.sh
./build.sh
```

2. Запуск и тестирование:
	- Для запуска сервера требуется из корня проекта выполнить следующие команды:
		**Linux:**
		```bash
		cd /build/src
		./Server <port> <log_dir> <dump_dir> [<dump_file>]
		``` 
		- **port** - порт, на котором сервер будет слушать
		- **log_dir** - абсолютный путь к директории, в которую попадет файлы с логами сервера
		- **dump_dir** - абсолютный путь к директории, в которую попадут dump-файлы хранилища
		- **dump_file** - абсолютный путь к dump-файлу, который будет загружен на сервер перед запуском его запуском

	- Для запуска клиента требуется из корня проекта выполнить следующие команды:
		**Linux:**
		```bash
		cd /build/src
		./Client <ip> <port>
		``` 
		- **ip** - ip-адрес сервера
		- **port** - порт, на котором сервер слушает сервер

---
### Команды
Все пары ключ-значение предаставляют пары двух слов, то есть ни ключ, ни значение не могут быть длиннее, чем одно слово. Команды всегда должны быть написаны заглавными буквами. Ключом могут быть лишь последовательности символов из цифр (0-9), латинских букв строчных и заглавных (a-zA-Z). Ввод любой команды заканчивается символом `"\n"`.

**Команды:**
- `PUT <key> <value>` - Сохраняет пару ключ-значение на сервере. При успешном выполнении клиенту вернется сообщение `OK`, при неверном запросе -- `NE`. Если на сервере уже хранится такой ключ, то его значение перезаписывается новым, а клиент получит `OK <old_value>`.
- `GET <key>` - Возвращает значение указанного ключа на сервере. При успешном выполнении клиенту вернется сообщение `OK <value>`, при неверном запросе или отсутствии такого ключа -- `NE`.
- `DEL <key>` - Удаляет пару ключ-значение и возвращает значение указанного ключа на сервере. При успешном выполнении клиенту вернется сообщение `OK <value>`, при неверном запросе или отсутствии такого ключа -- `NE`.
- `COUNT` - Возвращает текущее количество пар ключ-значение на сервере. При успешном выполнении клиенту вернется сообщение `OK <count_pairs>`, при неверном запросе -- `NE`.
- `DUMP <file.txt>` - Сохраняет в файл txt (обязательно, также имя файла может содержать лишь сиволы `[0-9a-zA-Z]`) все пары с сервера на текущий момент. При успешном выполнении клиенту вернется сообщение `OK`, при неверном запросе или неверном имени файла -- `NE`.

---
### Важные замечания
- В параметры сервера должны передавться лишь существующие пути к папкам и файлам, если это условие не выполняется сервер не запустится.
- Если в команду `DUMP` передано валидное имя файла, данные сохраняются в файл и в начале его названия будет добавлена приписка `dump_`.
- Файлы логгирования при старте сервера будут иметь имена с текущим временем старта сервера в формате `%Y-%m-%d__%H-%M-%S.txt` (Y -- год, m -- месяц, d -- день, H -- час, M -- минута, S -- секунда).
- И сервер, и клиент останавливаются путем остановки процесса (`SIGINT`).
